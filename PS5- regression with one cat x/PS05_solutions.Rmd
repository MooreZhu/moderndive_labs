
---
title: "Problem Set 07"
author: "WRITE YOUR NAME HERE"
date: "WRITE DATE HERE"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_depth: 2
    toc_float:
      collapsed: false
    df_print: kable
---

```{r, include=FALSE}
# Do not edit this code block/chunk
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE, fig.width = 16/2, fig.height = 9/2)
```

## Collaboration {-}

Please indicate who you collaborated with on this problem set: 


## Background {-}

In this problem set we will work with some hate crimes data from the US.  The FiveThirtyEight article article about those data are in the Jan 23, 2017  ["Higher Rates Of Hate Crimes Are Tied To Income
Inequality"](https://fivethirtyeight.com/features/higher-rates-of-hate-crimes-are-tied-to-income-inequality/)

We will use these data in this Problem Set to run regression models with a single categorical predictor (explanatory) variable. 

## Setup
First load the necessary packages 

```{r}
library(ggplot2)
library(dplyr)
library(moderndive)
library(fivethirtyeight)
library(readr)
```


Next load the data set, from where it is stored on the web: 
```{r}
hate_crimes <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vTluPzQ4ou81CtyFNiVuvmRUC5ZVj8YPUSrE6FxGtIp9J-8Eqdq7g9bWPI7u64vFDXJGldjJbqcT6oo/pub?gid=1616495486&single=true&output=csv")
```

Be sure to take a look at the data in the viewer, and take a glimpse at the data like so: 

```{r eval = F}
glimpse(hate_crimes)
```

<br> 

Each case/row in these data is a state in the US. The response variable we will consider is `hate_crimes`, which is the number of hate crimes per 100k individuals in the 10 days after the 2016 US election as measured by the Southern Poverty Law Center (SPLC). 

We have three categorical explanatory variables in this data set: 

* `trump_support`: level of Trump support in 2016 election (low, medium or high)

* `unemployment`: level of unemployment in a state (low or high)

* `median_house_inc`: median household income in the stat (low or high)


<br> 

*** 

## Hate Crimes and Trump Support

Let's start by modeling the relationship between:

* $y$: `hate_crimes` per 100K individuals 
* $x$: Level of `trump_support` in the state: `low`, `medium`, or `high`

<br> 

# Question 1.A 
Create a visual model of these data (a graph) that will allow you to conduct an "eyeball test" of the relationship between hate crimes per 100K and level of Trump support. Include appropriate axes labels and a title.

```{r}
ggplot(data = hate_crimes, aes(x = trump_support, y = hate_crimes)) + 
  geom_boxplot() + 
  labs(x = "Voter Support of Trump", 
       y = "Number of Hate Crimes per 100K people", 
       title = "WTF is going on here?")
```

# Question 1.B 
Comment on the relationship between these two variables.

**Answer:**

# Question 2
Now run a model that examines the relationship between hate crime rates and the level of Trump support. Generate a regression table.

```{r}
hate_mod <- lm(hate_crimes ~ trump_support, 
               data = hate_crimes)
get_regression_table(hate_mod)
```


# Question 3.A
What does the intercept mean in this regression table?

**Answer:** the intercept is the estimated hate crime rate for states with **high** support for Trump

# Question3.B
What does the model estimate as the number of hate crimes per 100000 people in states with  "low" Trump support?

**Answer:** 0.460

# Question 3.C
Does the model estimate that hate crimes are more frequent in states that show "low" or "high" support for Trump?

**Answer:** Hate crimes are more frequent in stats that show "low" support

# Question 3.D
How much greater were hate crimes in "medium" trump-support states compared to "high" trump-support states?

**Answer:** 0.031
 
# Question 3.E
What are the three possible fitted values $\widehat{y}$ for this model? (Hint: use the `get_regression_points`) function to explore this if you are not sure!

**Answer:** The three possible fitted values are 0.460, 0.191, & 0.222
 
```{r eval = F}
0.460- 0.269
0.460- 0.238
get_regression_points(hate_mod)
```

<br> 
***

## The regression equation

The regression equation for this model is the following (knit it to look at output!)

<br> 

$\widehat{y} = 0.191 + 0.269 \times is\_trump\_support_{low} + 0.031 \times is\_trump\_support_{med}$

<br> 


So for instance, in a state in which `trump_support` is "low"  you would plug in 1 for $is\_trump\_support_{low}$, and 0 in for  $is\_trump\_support_{med}$ and solve like so:

***

$\widehat{y} = 0.191 + 0.269 \times 1 + 0.031 \times 0$

$\widehat{y} = 0.191 + 0.269$

$\widehat{y} = 0.460$

***

<br>

# Question 4
Solve the regression equation for a state in which `trump_support` is "high"

**Answer:** 
$\widehat{y} = 0.191 + 0.269 \times 0 + 0.031 \times 0$

$\widehat{y} = 0.191 + 0$

$\widehat{y} = 0.191$

# Question 5
Which 5 states had the highest rate of hate crimes? What was the level of Trump support in these 5 states? [You can solve this any way you choose...]

Do these results surprise you? There is no right answer to this question

```{r}
hate_crimes %>% 
  arrange(desc(hate_crimes)) %>% 
  slice(1:5)
```

**Answers:** DC, Oregon, Washington, MA , Minnesota- These states all had "low" Trump support. 

Super surprised. There must be another variable that is driving this. Or perhaps measuring at the unit level of the state is misleading giving the gerymandering

<br> 
*** 
<br> 

## Hate crimes and unemployment  

We will next model the relationship between: 

* $y$: `hate_crimes` per 100K individuals  after the 2016 US election 
* $x$: Level of unemployment in the state (`low`, or `high`)

<br> 

# Question 6
Create a visual model of this data (a graph) that will allow you to conduct an "eyeball test" of the relationship between hate crimes per 100K and unemployment level. Include appropriate axes labels and a title.

```{r}
ggplot(data = hate_crimes, aes(x = unemployment, y = hate_crimes)) + 
  geom_boxplot() + 
  labs(x = "Unemployment rate", 
       y = "Number of Hate Crimes per 100K people", 
       title = "Trump is Evil")
```

# Question 7.A
Now run a model that examines the relationship between hate crime rates and the unemployment level. Generate a regression table.

```{r}
job_mod <- lm(hate_crimes ~ unemployment, 
               data = hate_crimes)
get_regression_table(job_mod)
```

# Question 7.B
Write out the regression equation for this model. 

**Answer:** 
$\widehat{y} = 0.289 + 0.031 \times is\_unemployment_{low}$

# Question 7.C
What does the intercept mean in this regression table?

**Answer:** It shows the estimated hate crime for the states with  **high** unemployment

# Question 7.D
What does the model estimate as the number of hate crimes per 100000 people in states with  "low" unemployment?

**Answer:** This would be 0.32 (0.031 +  0.289)

# Question 7.E
What are the two possible fitted values $\widehat{y}$ for this model? Why are there only two this time? (there were three in the last question)

The two possible fitted values are 0.32 and 0.289...there are two this time because there are only two levels to this variable. 


# Question 8
Use the `get_regression_points` function to generate a table showing the predictions, and the residuals for the model relating `hate_crimes` to unemployment.  Examine the first row:  How are the residuals calculated here? 

```{r eval = F}
get_regression_points(job_mod)
```
 
**Answer:** They are calculated by subtracting the predicted hate crime value from the observed hate crime. 
For instance, in the first row. 0.295- 0.289 = 0.006

<br> 

***

<br> 

## Hate crimes and household income 

# Question 9 
Now run a model that examines the relationship between `hate_crimes` and median household income in the state (`median_house_inc`). 

```{r include = F}
inc_mod <- lm(hate_crimes ~ median_house_inc, data = hate_crimes)
get_regression_table(inc_mod)
```


# Question 9.A 
Were there more hate crimes in areas with high or low median household incomes? How large was the difference between states with "low" and "high" levels of household income?


**Answer:** there were roughly 0.16 more hate crimes on average per 100K people in areas with high income compared to areas with low household income. That is kind of surprising!  

# Question 10
Run the `get_regression_points()` function for the `hate_crimes` and `median_house_inc` model. 

```{r include = F}
get_regression_points(inc_mod)
```

# Question 10.A
Take a look at the second case (ID2), which is Maine. Did the model **overpredict** or **underpredict** the `hate_crimes` level, compared to what was observed in the data?

**Answer:** 0.229  was predicted, 0.616 was observed, so the model under predicted


***

[//]: (students- please do not delete anything below this line!) 

<style type="text/css">
h1 { /* Header 1 */
  color: Blue;
}}
</style>

